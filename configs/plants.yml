version: 1
root_folder: "C:\\Dev\\plant-rates\\plantrates\\src\\Components"
grain:
  - plant
  - period
  - product
  - mat_group
  - cost_element
  - rate
  - qty
normalize:
  trim_whitespace: true
  collapse_internal_spaces: true
normalize_plant_from_filename:
  - pattern: "(?i)EUF"
    to: "EUF"
  - pattern: "(?i)MCI"
    to: "MCI"
  - pattern: "(?i)(New\\s*Iberia|\\bNI\\b)"
    to: "NI"
  - pattern: "(?i)TMB"
    to: "TMB"
periods:
  include_sheets:
    - Nov25
    - Dec25
    - Jan
    - Feb
    - Mar
    - Apr
    - May
    - Jun
    - Jul
    - Aug
    - Sep
    - Oct
    - Nov
    - Dec
  mapping:
    Nov25: "2025/11"
    Dec25: "2025/12"
    Jan: "2026/01"
    Feb: "2026/02"
    Mar: "2026/03"
    Apr: "2026/04"
    May: "2026/05"
    Jun: "2026/06"
    Jul: "2026/07"
    Aug: "2026/08"
    Sep: "2026/09"
    Oct: "2026/10"
    Nov: "2026/11"
    Dec: "2026/12"
mapping:
  product_map_csv: "configs/product_map.csv"
plants:
  - match: "(?i)EUF"
    plant_code: "EUF"
    ruleset: "cross_tab_euf_mci"
  - match: "(?i)MCI"
    plant_code: "MCI"
    ruleset: "cross_tab_euf_mci"
  - match: "(?i)(New\\s*Iberia|\\bNI\\b)"
    plant_code: "NI"
    ruleset: "cross_tab_ni_rc"
    qty_multipliers:
      Materials: 0.3333333333
  - match: "(?i)TMB"
    plant_code: "TMB"
    ruleset: "cross_tab_tmb"
rulesets:
  cross_tab_euf_mci:
    layout:
      product_row: 3
      product_start_column: "B"
      product_stride: 1
      cost_elements:
        label_column: "A"
        start_row: 6
        stop_before_text_ilike: "Total Fixed Costs"
        exclude_rows_ilike:
          - "Total Fixed Costs"
          - "Total Variable Costs"
      production:
        match:
          type: contains_ilike
          values:
            - "PRODUCTION ( in 000 lbs )"
            - "TOTAL PRODUCTION (000 lbs)"
    cost_element_normalization:
      - type: contains
        pattern: "Materials"
        to: "Materials"
      - type: equals
        pattern: "Electricity"
        to: "Electricity"
      - type: equals
        pattern: "Gas"
        to: "Gas"
      - type: startswith
        pattern: "R\\s*&\\s*M"
        to: "R&M"
      - type: startswith
        pattern: "Manufacturing"
        to: "Manufacturing"
      - type: startswith
        pattern: "Other"
        to: "Other"
      - type: equals
        pattern: "Production\\s+Labor"
        to: "Production Labor"
      - type: startswith
        pattern: "Repairs\\s*&\\s*Maintenance\\s*Labor"
        to: "R&M Labor"
      - type: equals
        pattern: "R\\s*&\\s*M\\s*Labor"
        to: "R&M Labor"
      - type: contains
        pattern: "Indirect\\s+Payroll"
        to: "Indirect Labor"
      - type: equals
        pattern: "Supervision"
        to: "Supervision"
      - type: equals
        pattern: "Depreciation"
        to: "Depreciation"
      - type: equals
        pattern: "Insurance\\s*&\\s*Taxes"
        to: "Insurance & Taxes"
  cross_tab_tmb:
    layout:
      product_bands:
        - product_row: 3
          product_start_column: "B"
          product_stride: 1
          cost_elements:
            label_column: "A"
            start_row: 6
        - product_row: 26
          product_start_column: "B"
          product_stride: 1
          cost_elements:
            label_column: "A"
            start_row: 29
      cost_elements:
        stop_before_text_ilike: "Total Fixed Costs"
        exclude_rows_ilike:
          - "Total Fixed Costs"
          - "Total Variable Costs"
      production:
        match:
          type: contains_ilike
          values:
            - "PRODUCTION ( in 000 lbs )"
            - "TOTAL PRODUCTION (000 lbs)"
    cost_element_normalization:
      - type: contains
        pattern: "Materials"
        to: "Materials"
      - type: equals
        pattern: "Electricity"
        to: "Electricity"
      - type: equals
        pattern: "Gas"
        to: "Gas"
      - type: startswith
        pattern: "R\\s*&\\s*M"
        to: "R&M"
      - type: startswith
        pattern: "Manufacturing"
        to: "Manufacturing"
      - type: startswith
        pattern: "Other"
        to: "Other"
      - type: equals
        pattern: "Production\\s+Labor"
        to: "Production Labor"
      - type: startswith
        pattern: "Repairs\\s*&\\s*Maintenance\\s*Labor"
        to: "R&M Labor"
      - type: equals
        pattern: "R\\s*&\\s*M\\s*Labor"
        to: "R&M Labor"
      - type: contains
        pattern: "Indirect\\s+Payroll"
        to: "Indirect Labor"
      - type: equals
        pattern: "Supervision"
        to: "Supervision"
      - type: equals
        pattern: "Depreciation"
        to: "Depreciation"
      - type: equals
        pattern: "Insurance\\s*&\\s*Taxes"
        to: "Insurance & Taxes"
  cross_tab_ni_rc:
    layout:
      product_row: 3
      product_start_column: "B"
      product_stride: 3
      cost_elements:
        label_column: "A"
        start_row: 6
        stop_before_text_ilike: "Total Fixed Costs"
        exclude_rows_ilike:
          - "Total Fixed Costs"
          - "Total Variable Costs"
      production:
        match:
          type: contains_ilike
          values:
            - "PRODUCTION ( in 000 lbs )"
            - "TOTAL PRODUCTION (000 lbs)"
    cost_element_normalization:
      - type: startswith
        pattern: "Materials"
        to: "Materials"
      - type: equals
        pattern: "Electricity"
        to: "Electricity"
      - type: equals
        pattern: "Gas"
        to: "Gas"
      - type: startswith
        pattern: "R\\s*&\\s*M"
        to: "R&M"
      - type: startswith
        pattern: "Manufacturing"
        to: "Manuf."
      - type: startswith
        pattern: "Other"
        to: "Other"
      - type: equals
        pattern: "Production\\s+Labor"
        to: "Production Labor"
      - type: startswith
        pattern: "Repairs\\s*&\\s*Maint"
        to: "R&M Labor"
      - type: contains
        pattern: "Indirect\\s+Payroll"
        to: "Indirect Labor"
      - type: equals
        pattern: "Supervision"
        to: "Supervision"
      - type: equals
        pattern: "Depreciation"
        to: "Depreciation"
      - type: equals
        pattern: "Insurance\\s*&\\s*Taxes"
        to: "Insurance & Taxes"
output:
  columns:
    - plant
    - period
    - product
    - mat_group
    - element_code
    - rate
    - qty
    - cost
    - source_path
