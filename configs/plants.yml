version: 1
root_folder: "\\\\192.168.155.84\\RPT\\CRR\\Budget\\Components"
normalize_plant_from_filename:
  - pattern: "(?i)EUF"
    to: "EUF"
  - pattern: "(?i)MCI"
    to: "MCI"
  - pattern: "(?i)(New\\s*Iberia|\\bNI\\b)"
    to: "NI"
  - pattern: "(?i)TMB"
    to: "TMB"
plants:
  - match: "(?i)EUF"
    plant_code: "EUF"
    ruleset: "cross_tab_v1"
  - match: "(?i)MCI"
    plant_code: "MCI"
    ruleset: "cross_tab_v1"
  - match: "(?i)(New\\s*Iberia|\\bNI\\b)"
    plant_code: "NI"
    ruleset: "cross_tab_v1"
  - match: "(?i)TMB"
    plant_code: "TMB"
    ruleset: "cross_tab_v1"
periods:
  include_sheets:
    - Nov25
    - Dec25
    - Jan
    - Feb
    - Mar
    - Apr
    - May
    - Jun
    - Jul
    - Aug
    - Sep
    - Oct
    - Nov
    - Dec
  mapping:
    Nov25: "2025/11"
    Dec25: "2025/12"
    Jan: "2026/01"
    Feb: "2026/02"
    Mar: "2026/03"
    Apr: "2026/04"
    May: "2026/05"
    Jun: "2026/06"
    Jul: "2026/07"
    Aug: "2026/08"
    Sep: "2026/09"
    Oct: "2026/10"
    Nov: "2026/11"
    Dec: "2026/12"
rulesets:
  cross_tab_v1:
    layout:
      product_row: 3
      product_start_column: "B"
      cost_elements:
        start_row: 6
        stop_before_text_ilike: "Total Fixed Costs"
        exclude_rows_ilike:
          - "Total Fixed Costs"
          - "Total Variable Costs"
      production:
        row_match_ilike:
          - "^\\s*TOTAL\\s*PRODUCTION\\s*\\(.*000\\s*lbs.*\\)\\s*$"
          - "^\\s*PRODUCTION\\s*\\(.*000\\s*lbs.*\\)\\s*$"
    output:
      columns:
        - plant
        - period
        - product
        - element_code
        - rate
        - qty
        - currency
        - rate_uom
        - source_path
      defaults:
        currency: "USD"
        rate_uom: "USD/ton"
    mapping:
      cost_element_csv: "configs/map_cost_element.csv"
